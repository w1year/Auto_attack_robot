void YOLODetectorTensorRT::preprocessImage(const cv::Mat& image, float* gpu_Input, const cudaStream_t& stream) {
    // 1. 暴力缩放 (Direct Resize) - 不加黑边，直接拉伸到 640x640
    cv::Mat resized;
    cv::resize(image, resized, cv::Size(m_inputWidth, m_inputHeight));
    
    // 2. 颜色转换 (BGR -> RGB) - 修复颜色识别错误
    cv::Mat rgb;
    cv::cvtColor(resized, rgb, cv::COLOR_BGR2RGB);

    // 3. 归一化 (0-255 -> 0.0-1.0)
    cv::Mat normalized;
    rgb.convertTo(normalized, CV_32F, 1.0 / 255.0);

    // 4. HWC -> CHW (通道分离)
    std::vector<cv::Mat> channels(3);
    cv::split(normalized, channels);

    int channelSize = m_inputWidth * m_inputHeight * sizeof(float);

    // 拷贝到 GPU (R, G, B 顺序)
    cudaMemcpyAsync(gpu_Input, channels[0].data, channelSize, cudaMemcpyHostToDevice, stream);
    cudaMemcpyAsync(gpu_Input + m_inputWidth * m_inputHeight, channels[1].data, channelSize, cudaMemcpyHostToDevice, stream);
    cudaMemcpyAsync(gpu_Input + 2 * m_inputWidth * m_inputHeight, channels[2].data, channelSize, cudaMemcpyHostToDevice, stream);
}
